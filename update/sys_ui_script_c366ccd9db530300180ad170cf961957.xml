<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_ui_script">
    <sys_ui_script action="INSERT_OR_UPDATE">
        <active>true</active>
        <description>Client-side logic for Angular App</description>
        <global>false</global>
        <name>x_183199_testcommv.angular_app_client_lo</name>
        <script><![CDATA[angular.module('angularapp',[]);

angular.module('angularapp').controller('ScheduleController', function($scope){
	console.log('In schedule controller');
	$scope.onAjax = true;
	$scope.getSchedules = function() {
		$scope.onSchedules = function(response) {
			var answer = response.responseXML.documentElement.getAttribute("answer");
			$scope.schedules = JSON.parse(answer);
			$scope.onAjax = false;
			$scope.$apply();
			console.log($scope.schedules);
		};
		
		var getScheduleEndpoint = new GlideAjax('TestCommvaultEndpoint');
		getScheduleEndpoint.addParam('sysparm_name','getSchedules');
		getScheduleEndpoint.getXML($scope.onSchedules);
	};
	
	$scope.getSchedules();
});

angular.module('angularapp').controller('ViewClientsController', function($scope){
	$scope.onAjax = true;
	$scope.getClients = function() {
		$scope.onGetClients = function(response) {
			var answer = response.responseXML.documentElement.getAttribute("answer");
			$scope.getClientResponse = JSON.parse(answer);
			$scope.onAjax = false;
			$scope.$apply();
			console.log($scope.getClientResponse);
		};
		
		var getClientsEndpoint = new GlideAjax('TestCommvaultEndpoint');
		getClientsEndpoint.addParam('sysparm_name','getClients');
		getClientsEndpoint.getXML($scope.onGetClients);
	};
	
	$scope.getClients();
});

angular.module('angularapp').controller('AngularAppCtrl', function($scope){
	$scope.myVar = "This is the value of myVar";
	$scope.btnText = "Perform backup";
	
	$scope.callWorkflow = function() {
		console.log('Calling workflow');
		$scope.btnText = "Sending request";
		
		$scope.callback = function (response) {
			var answer = response.responseXML.documentElement.getAttribute("answer"); 
			$scope.btnText = "Perform backup";
			$scope.$apply();
			console.log(response);
			console.log(answer);
		};
		
		var getHelloAddr = new GlideAjax('TestCommvaultEndpoint');

		getHelloAddr.addParam('sysparm_name','getSchedules');

		getHelloAddr.getXML($scope.callback);
	};
});]]></script>
        <script_name>angular_app_client_logic</script_name>
        <sys_class_name>sys_ui_script</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2017-12-26 13:21:18</sys_created_on>
        <sys_id>c366ccd9db530300180ad170cf961957</sys_id>
        <sys_mod_count>36</sys_mod_count>
        <sys_name>x_183199_testcommv.angular_app_client_lo</sys_name>
        <sys_package display_value="TestCommvault" source="x_183199_testcommv">3aafe741db130300180ad170cf961919</sys_package>
        <sys_policy/>
        <sys_scope display_value="TestCommvault">3aafe741db130300180ad170cf961919</sys_scope>
        <sys_update_name>sys_ui_script_c366ccd9db530300180ad170cf961957</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2018-02-12 13:35:37</sys_updated_on>
        <use_scoped_format>false</use_scoped_format>
    </sys_ui_script>
</record_update>
